/*****************************************
 * 
 * Project: Cube Application Heine
 * Package Type: JSF Online Module
 * Create by: amao.xu@altran.com
 * Date: 10.06.2013
 *
 *****************************************/
package de.heine.cube.online.sessionbean;

import java.io.Serializable;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;
import javax.servlet.http.HttpSession;

import org.apache.log4j.Logger;

import de.heine.cube.common.dto.PatientVO;
import de.heine.cube.common.dto.UserVO;

/**
 * 
 * 
 * @author axu
 *
 */
@ManagedBean(name="sessionBean",eager=true)
@SessionScoped
public class SessionScopeBean implements Serializable{
	
	private static final Logger log = Logger.getLogger(SessionScopeBean.class.getName());
	
	/**
	 * 
	 */
	private static final long serialVersionUID = -3725974060965998866L;
	
	public SessionScopeBean (){
		log.info("SessionBean initialized");
		HttpSession session = ( HttpSession )FacesContext.getCurrentInstance().getExternalContext().getSession(true);
		log.debug("SessionID:"+session.getId());
	}
	
	public void setLogin(UserVO username){
		HttpSession session = ( HttpSession ) FacesContext.getCurrentInstance().getExternalContext().getSession(false);
		session.setAttribute("username", username);
		log.info("User:"+username+" is currently loggedin.");
	}
	
	public UserVO getLogin(){
		HttpSession session = ( HttpSession ) FacesContext.getCurrentInstance().getExternalContext().getSession(false);
		UserVO user =(UserVO)session.getAttribute("username");
		log.info("Login User Information: "+user.toString());
		return user; 
	}
	
	public void setLogout(){
		log.info("session is removed");
		FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
	}
	
	public void setCurrentPatient(PatientVO patientVO){
		HttpSession session = ( HttpSession ) FacesContext.getCurrentInstance().getExternalContext().getSession(false);
		session.setAttribute("patientVO", patientVO);
	}
	
	public PatientVO getCurrentPatient(){
		HttpSession session = ( HttpSession ) FacesContext.getCurrentInstance().getExternalContext().getSession(false);
		return (PatientVO)session.getAttribute("patientVO");
	}
}
