/**
 * javascript Function for HomepageResize
 */
var home_do_layout = function(){
	framework_Do_Layout();
	/**
	 * Page oriented function
	 */
	if( $(".patientlistButton").position().left==0){
		$("#patientlistLayer").offset({left: 140});
	}else{
		$(".patientlistButton").offset({left: window.innerWidth-140});
		$("#patientlistLayer").offset({left: window.innerWidth});
	}
	
	bodymap_with_leftColumn_do_layout();
	
};

/**
 * calculate LeftColumnwidth
 */
var leftColumnwidth = function(){
	return Math.round((window.innerHeight/6-20)/3*8+22);
};

var bodymap_with_leftColumn_do_layout = function(){
	$('.imageThumbnailNormal').height(Math.round(window.innerHeight/6-20));
	console.info(leftColumnwidth());
	
	bodymap_do_layout();
};

var leftColumnImageHeight = function(){
	return Math.round(window.innerHeight/6-20);
};

/**
 * calculate rightColumnwidth
 */
var rightColumnwidth = function(){
	return 240;
};

/**
 * Home bodymap_do_layout
 */
var bodymap_do_layout = function(){
	var innerWidth = window.innerWidth;
	var innerHeight = window.innerHeight;
	
	var BM_LEFT_WIDTH = 269; // width of left bodymap image 
	var BM_FRONT_WIDTH = 235; // width of front bodymap image
	var BM_RIGHT_WIDTH = 269; // width of right bodymap image
	var BM_BACK_WIDTH = 235; // width of back bodymap image
	
	var LOCATION_SPACE = 35; // width reserved for displaying location info
	var BETWEEN_LOCATION_SPACE = 5; // width reserved for space between location info
	var BM_HEIGHT = 719; // height of the bodymap images
	var bodymapRatio = 1; // current active ratio (zoomfactor) for full bodymap
	
	// calculate available space for centerPane
	// LeftColumnwidth and rightColumnwidth can differ from page to page
	var centerWidth = innerWidth - leftColumnwidth()-rightColumnwidth();
	var centerHeight = innerHeight - 120;
	
	console.info("CenterWidth:"+centerWidth+" CenterHeight:"+centerHeight);
	
	$("#centercolumn").width(centerWidth);
	$("#centercolumn").height(centerHeight);
	$("#centercolumn").css("top", 0);
	$("#centercolumn").css("left", leftColumnwidth);
	
	$("#leftcolumn").width(leftColumnwidth);
	
	// bodymap in 4 parts must be arranged in center with space in between
	// left + front + right + back; + (8*space for locations) + 3*space between locations
	var originalBodymapWidth = BM_LEFT_WIDTH + BM_FRONT_WIDTH + BM_RIGHT_WIDTH + BM_BACK_WIDTH;
	var availableWidthForBodymap = centerWidth - 8 * LOCATION_SPACE - 3 * BETWEEN_LOCATION_SPACE;
	var originalBodymapHeight = BM_HEIGHT;
	var bodymapWidthRatio = availableWidthForBodymap / originalBodymapWidth;
	var bodymapHeightRatio =  centerHeight / originalBodymapHeight;
	bodymapRatio = Math.min(bodymapWidthRatio, bodymapHeightRatio);
	// offset for centering
	var offsetTop = (centerHeight - bodymapRatio * BM_HEIGHT) / 2;
	var offsetLeft = (availableWidthForBodymap - bodymapRatio * originalBodymapWidth) / 2;
	$("#bodymapLeft").width(BM_LEFT_WIDTH * bodymapRatio);
	$("#bodymapLeft").height(BM_HEIGHT * bodymapRatio);
	$("#bodymapLeft").css("top", offsetTop);
	$("#bodymapLeft").css("left", offsetLeft + LOCATION_SPACE);
	$("#bodymapFront").width(BM_FRONT_WIDTH * bodymapRatio);
	$("#bodymapFront").height(BM_HEIGHT * bodymapRatio);
	$("#bodymapFront").css("top", offsetTop);
	$("#bodymapFront").css("left", offsetLeft + BM_LEFT_WIDTH * bodymapRatio + 3 * LOCATION_SPACE + BETWEEN_LOCATION_SPACE);
	$("#bodymapRight").width(BM_RIGHT_WIDTH * bodymapRatio);
	$("#bodymapRight").height(BM_HEIGHT * bodymapRatio);
	$("#bodymapRight").css("top", offsetTop);
	$("#bodymapRight").css("left", offsetLeft + BM_LEFT_WIDTH * bodymapRatio + BM_FRONT_WIDTH * bodymapRatio + 5 * LOCATION_SPACE + 2 * BETWEEN_LOCATION_SPACE);
	$("#bodymapBack").width(BM_BACK_WIDTH * bodymapRatio);
	$("#bodymapBack").height(BM_HEIGHT * bodymapRatio);
	$("#bodymapBack").css("top", offsetTop);
	$("#bodymapBack").css("left", offsetLeft + BM_LEFT_WIDTH * bodymapRatio + BM_FRONT_WIDTH * bodymapRatio + BM_RIGHT_WIDTH * bodymapRatio + 7 * LOCATION_SPACE + 3 * BETWEEN_LOCATION_SPACE);
	
};

/**
 * JQuery Format functions
 */
$(function() {
	  $('.patientlistText').hover(
				function(){
					 $('.patientlistButton').css('background-image','url(resources/images/btnPatientlistHover.png)');
				 }
				 ,
				 function(){
				  $('.patientlistButton').css('background-image','url(resources/images/btnPatientlistNormal.png)');
				  }
	 );

	 $('#addPatientButton').click( function (){
		 $('#layerContainer').css('display','none');
		 $('#layerContainer2').css('display','inline');
	 });

	 $('.patientlistText').click( function (){
		 	console.info("0px + 140px");
			if( $(".patientlistButton").position().left !=0){

				 console.info("0px + 140px");
				 $(".patientlistButton").animate({
			    	 left: '0px'
			    	 }, 500 );
 	 		 $("#patientlistLayer").animate({
			    	 left: '140px'
			    	 }, 500 );
				}else{

				console.info((window.innerWidth-140)+"px + "+ window.innerWidth+"px");
				$(".patientlistButton").animate({
			    	 left: (window.innerWidth-140)+'px'
			    	 }, 500 );

 	 		 $("#patientlistLayer").animate({
			    	 left: window.innerWidth+'px'
			    	 }, 500 );
				}

	 	   }
	  );
	  

	 /**
	  * Image enlargen function:
	  * 
	  */
	 $('.imageThumbnailNormal').click( function (){
		
		 /**
		  * Image is not enlarged.
		  */
		 if($('.imageFlyout').css('display')=='block'){
			 
			 $(this).animate({
				 height: Math.round(window.innerHeight/6-20)
	    	 }, 500, function (){
	    		 $(this).css('z-index','auto');
				 $(this).css('position','');
				 $(this).removeAttr('left');
				 $(this).css('top','0px');
		     });
			 $('.imageFlyout').css('display','none');
			 $('.imageFlyout').css('left','0px');
			 
 		 }else{
 			var bigImageHeight = Math.round(window.innerHeight/5*3-120);
 			var bigImagewidth = Math.round((window.innerHeight/5-40)*4);
				 $(this).css('position','fixed');
	    		 $(this).css('left','0px');
	    		 $(this).css('top','60px');
	    		 $(this).css('z-index','10');
		    		 $(this).animate({
			    	 height: bigImageHeight
			    	 }, 500 ,function() {
			    		 $('.imageFlyout').css('top','60px');
			    		 $('.imageFlyout').css('height',bigImageHeight);
			    		 $('.imageFlyout').css('width',bigImagewidth);
			    		 $('.imageFlyout').css('display','inline');
			    		 $('.imageFlyout').animate({
			    			 left: $(this).width()
					    	 }, 500);

			    		tempImagewidth= bigImagewidth;
			    	 });
		 }
	 });

	 $('.iconTurn').click( function (){
		 if( $('.imageFlyout').position().left !=60){
 		 $('.imageFlyout').animate({
	    	 left: '60px'
	    	 }, 500);
 		 $('.iconTurn').css('background-image','url(resources/images/iconTurnRight.png)');
		 }else{
			 $('.imageFlyout').animate({
		    	 left: tempImagewidth+'px'
		    	 }, 500);
			 $('.iconTurn').css('background-image','url(resources/images/iconTurnLeft.png)');
 	  }
	 });

	 $('.compareSmallNormal').click( function (){
		 window.location.href='/cube-online-module-0.0.1-SNAPSHOT/Compare.xhtml';
	 });

	 $('.editPatient').click( function(){
			$('#patienteditLayer').css('display','inline');
 	 }
	);

});